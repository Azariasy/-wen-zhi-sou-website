# 文件搜索工具商业化初步实施计划 (v0.6)

**文档目的**: 本计划旨在明确文件搜索工具从当前阶段向包含免费版和付费专业版的商业化模式过渡的初步实施步骤，重点关注功能区分、初期线上展示（GitHub Pages）以及支付与授权机制（第三方平台）的规划。

**更新记录**: 
- v0.1: 初始版本
- v0.2: 增加功能实现进度、更新后续行动计划，优化UI与许可证控制
- v0.3: 更新功能实现进度，完善许可证管理界面，修复线程管理问题，优化错误处理
- v0.4: 更新UI主题实现进度，增强图标生成系统，改进线程管理，修复编译问题
- v0.5: 更新主题功能差异化策略，明确基础版仅支持蓝色主题，专业版支持多样化主题选择
- v0.6: 更新主题系统实现进度，简化主题系统，保留三种现代主题（蓝色、绿色、紫色）

---

## 一、 版本功能区分 (免费版 vs 专业版)

**核心原则**:
*   提供 **单一应用程序包**，用户下载安装后默认为免费版。
*   专业版功能通过 **许可证密钥 (License Key)** 激活解锁，无需重新安装。
*   免费版提供核心价值，吸引用户使用；专业版提供显著增强的功能和效率，驱动用户付费。

**实现方式**:
*   在代码中设置功能开关/标志位。
*   程序启动或特定功能调用时，检查许可证激活状态。
*   根据状态决定是否启用/禁用相关功能模块或界面元素。

**具体功能划分 (基于 `项目建设计划-新.md` v1.5)**:

**1. 基础版 (免费)**:
    *   **核心搜索**:
        *   常见格式内容索引与搜索: `.docx`, `.xlsx`, `.pptx`, `.txt`, `.html`, `.rtf`
        *   基础搜索语法: `AND`, `OR`, `NOT`, `短语搜索 ("")`
        *   文件名搜索 (针对上述常见格式及用户指定的文本类文件扩展名)
    *   **过滤与排序**:
        *   按文件大小、修改日期过滤
        *   按相关度、修改日期、大小排序 (提供默认排序选项)
    *   **结果展示**:
        *   列表展示匹配文件
        *   基础关键词高亮 (肯定性词语)
    *   **配置与限制**:
        *   单个索引存储位置
        *   有限数量的源目录索引 (例如，**最多 5 个** 根目录)
    *   **界面**:
        *   **仅支持标准蓝色主题**
        *   搜索历史记录

**2. 专业版 (付费 - 通过激活解锁)**:
    *   **包含所有基础版功能，并额外解锁:**
    *   **高级文件格式支持**:
        *   `.pdf` (包括**仅文本**和**OCR**): 索引和搜索 PDF 内容 (OCR 用于图像型/扫描版)
        *   `.md` (Markdown) 文件支持
        *   **邮件文件支持**: 深入索引 `.eml` 和 `.msg` 文件内容及元数据
        *   **压缩包内容支持**: 索引 `.zip` 和 `.rar` 压缩包内的文件内容 (需处理好密码/损坏情况)
        *   *(未来)* 支持更多专业格式
    *   **高级搜索功能**:
        *   通配符搜索 (`*`, `?`)
        *   **文件名搜索扩展**: 支持对主流视频 (如 `.mp4`, `.mkv`, `.avi`)、音频 (如 `.mp3`, `.wav`, `.flac`) 和图片 (如 `.jpg`, `.jpeg`, `.png`, `.gif`, `.bmp`) 文件的文件名进行索引和搜索。
        *   *(未来)* 正则表达式搜索
        *   *(未来)* 按特定元数据字段搜索 (如作者、标题、多媒体文件元数据如EXIF、ID3等)
    *   **性能与效率**:
        *   *(可能)* 优化的索引更新策略 (更智能的增量更新)
        *   *(可能)* 多线程文件内容提取以加速索引
    *   **高级配置与管理**:
        *   **无限制** 的源目录索引
        *   *(未来)* 支持配置多个独立的索引库
        *   *(未来)* 支持索引网络驱动器/NAS
        *   更详细的索引/提取参数配置 (超时、内容大小限制等)
        *   *(未来)* 索引库加密选项
        *   *(未来)* 保存和加载常用搜索条件
    *   **跨平台支持 (macOS, Linux)**: [新增章节]
        *   提供对 macOS 和主流 Linux 发行版的完整功能支持。
        *   针对不同操作系统优化文件系统交互和依赖管理。
        *   提供各平台原生的安装包或便捷的安装方式。
    *   **增强界面与体验**:
        *   **丰富的主题选择** (现代蓝、现代绿、现代紫等多种主题，可根据喜好切换)
        *   更丰富的搜索结果上下文展示 (如果 `structure_map` 效果好)
        *   *(未来)* 主题自定义功能，允许用户调整界面颜色
    *   **优先技术支持**:
        *   通过指定渠道 (如邮件) 提供优先响应服务

**实现进度 [新增]**:
*   **已完成**:
    *   后端许可证检查机制已初步实现，包括 `is_feature_available()` 函数
    *   成功应用许可证检查于 PDF、Markdown 和邮件功能
    *   修复了 MSG 文件提取功能中缺失的许可证检查逻辑，与 EML 文件处理保持一致
    *   完善了设置界面的许可证状态反馈，禁用了免费版中不可用的专业版功能选项
    *   为专业版功能添加了"专业版专享"标识，并在点击时显示升级提示
    *   在主界面添加了醒目的"升级到专业版"按钮（绿色高亮）
    *   修复了应用启动和关闭时的线程销毁问题，提高了程序稳定性
    *   增强了文件类型检查的错误处理，确保许可证限制的文件被正确记录
    *   优化了跳过文件对话框功能，允许按文件类型过滤包括"许可证限制文件"
    *   **实现了对因许可证限制而跳过的文件的重新处理逻辑，包括更新跳过文件记录**
    *   **主题系统实现**:
        *   **更新**: 完成主题系统简化，移除浅色、深色、金色和薄荷色主题
        *   **更新**: 保留现代蓝、现代绿和现代紫三种主题，提高界面一致性
        *   **更新**: 简化了图标生成系统，只为三种保留的主题生成图标
        *   **更新**: 改进了主题限制机制，确保基础版仅支持现代蓝主题
        *   成功实现现代三色主题样式，界面控件颜色与主题保持一致
        *   实现了自动生成与主题匹配的UI图标（下拉箭头、单选按钮、复选框等）
        *   主题功能与许可证系统完全集成，基础版仅支持标准蓝色主题
        *   **修复了不同主题下树视图选中项的高亮显示问题，确保三种主题都能正确突显选中项**
    *   修复了Python 3.13兼容性问题，解决了关键的编译错误
    *   完善了文件跳过对话框，提供更清晰的信息分类和交互功能
    *   **添加了`_open_path_with_desktop_services`方法，修复了点击搜索结果无法打开文件和文件夹的问题**
    *   **优化了链接点击处理，正确解码URL路径，提高了跨平台路径兼容性**
    *   **API与后端逻辑**:
        *   完成API端点 (`create-order`, `payment-callback`, `check-payment-status`) 的MongoDB数据库集成，实现订单创建、状态更新（包括支付成功后更新订单状态和存储许可证）、以及订单状态查询功能。相关数据库操作代码已激活。
        *   在支付成功回调 (`payment-callback`) 中集成 `nodemailer` 模块，替换原有模拟邮件发送逻辑，实现真实的许可证邮件自动发送功能。
        *   **易支付平台"授权支付域名"审核已通过，现可正式接入支付功能**
    *   **前端网站 (GitHub Pages)**:
        *   更新 `docs/purchase.html` 购买页面，调整价格显示为限时优惠 ¥9.9 (原价 ¥19.9)。
        *   在 `docs/purchase.html` 购买页面"立即购买"按钮前添加用户邮箱输入框，并更新JavaScript逻辑以获取和验证用户输入的邮箱。
        *   实现 `docs/purchase.html` 页面"立即购买"按钮的JavaScript逻辑，使其能够调用后端 `/api/create-order` 接口（使用相对路径）发起支付流程，并处理API返回的支付链接或错误信息。
    *   **部署与配置**:
        *   成功将所有相关的后端API代码、前端网站更改（包括 `nodemailer` 依赖的 `package.json` 和 `package-lock.json` 更新）通过Git推送至GitHub。
        *   确认Vercel已自动从GitHub拉取最新代码并成功部署，使得API和网站更新生效。
        *   完成Vercel项目中邮件发送功能所需的SMTP环境变量（针对Hotmail/Outlook.com）配置。
        *   在易支付商户后台完成"授权支付域名"的配置（添加 `azariasy.github.io`），审核已通过。
    *   **应用功能与打包**: [新增章节]
        *   实现应用内手动"检查更新"功能：在帮助菜单添加选项，程序可联网获取 `latest_version.json` 文件，比较版本并提示用户有新版本及更新内容。
        *   完成使用 PyInstaller 对 Windows 平台的初步打包工作，生成了包含所有依赖和数据文件的 `.exe` 可执行程序包。
        *   修复了打包后下拉框、单选按钮等控件图标丢失的问题。
*   **待完成**:
    *   实现主题预览功能，帮助用户在购买专业版前了解可用主题效果
    *   完善主题相关的错误处理，增强主题切换稳定性
*   **存在问题**:
    *   部分情况下线程管理仍可能出现不稳定，特别是在应用关闭时
    *   用户在遇到错误时的反馈机制较为简单，缺乏自动收集和分析系统

---

## 二、 GitHub Pages 初步建设

**目标**:
*   作为产品官方信息发布的主要渠道。
*   提供清晰的产品介绍和版本区分说明。
*   提供免费版/体验版的安全下载链接。
*   引导用户了解和购买专业版。
*   提供基础的文档和支持入口 (尤其是依赖安装说明)。

**内容规划 (初期)**:

1.  **首页 (Landing Page)**:
    *   简洁明了的标题和价值主张 (例如："为中文优化的下一代本地文件内容搜索引擎")。
    *   核心功能亮点介绍 (跨格式、OCR、中文优化、隐私保护)。
    *   主要界面截图或 GIF 演示。
    *   清晰的行动召唤 (Call to Action):
        *   **[下载免费版]** (指向 GitHub Releases)
        *   **[了解专业版 / 购买]** (指向购买页面/功能对比页)
2.  **功能介绍 / 版本对比页**:
    *   详细列出免费版和专业版的功能差异 (可使用表格)。
    *   突出专业版的核心优势和价值。
3.  **下载页**:
    *   提供最新稳定版的下载链接 (链接到 GitHub Releases 的 `.exe` 文件)。
    *   明确说明系统要求 (Windows 版本等)。
    *   **极其重要**: 提供 **清晰、图文并茂** 的外部依赖安装指南 (Tesseract OCR, Poppler for PDF)，包括下载地址和配置步骤。这是影响用户体验的关键！
4.  **购买/升级页**:
    *   再次强调专业版的好处。
    *   提供 **明确的购买按钮/链接**，指向选择的第三方支付平台的产品页面。
    *   (可选) 简单说明购买和激活流程。
5.  **文档/支持页 (初期)**:
    *   基础使用教程 (如何添加目录、如何搜索等)。
    *   常见问题解答 (FAQ)，特别是关于索引、依赖安装的问题。
    *   反馈渠道说明 (例如，GitHub Issues 链接或联系邮箱)。

**技术选型**:
*   **平台**: GitHub Pages
*   **实现**: 建议使用 **Jekyll** (GitHub Pages 内建支持) 配合 Markdown，方便内容管理和主题应用。也可以直接使用 HTML/CSS。
*   **设计**: 保持简洁、专业、易于导航。可以选择一个现成的 Jekyll 主题进行修改。

**实现进度 [新增]**:
*   **已完成**:
    *   创建了GitHub Pages基础结构，包括产品页面的主要框架
    *   完成了首页设计，包含产品介绍、核心功能和版本对比表格
    *   实现了详细的下载页，包含系统要求、下载链接和完整的依赖项安装指南
    *   设计了购买页面，清晰展示了专业版价格、特权和许可证激活流程
    *   **为网站创建了全文搜索和文件名搜索的HTML预览页面**
    *   **根据实际界面截图更新了首页（index.html）的搜索结果展示图片 (fulltext-search.jpg, filename-search.jpg)**
    *   **移除了购买页面（purchase.html）的激活步骤中的占位符图片**
    *   **将产品名称从"文件搜索工具"更新为"文智搜"，并修改了所有网页文件及应用程序相关部分的名称**
    *   **为"文智搜"项目创建了新的专用 Git 仓库**
    *   **成功配置 SSH 访问 GitHub，解决了代码推送问题**
    *   **将包含网站文件的 'docs' 目录和项目代码成功推送至 GitHub (`Azariasy/-wen-zhi-sou-website`)**
    *   **确认 GitHub Pages 部署成功，网站已可通过公开链接访问**
    *   **确认当前网站图片资源已满足初期需求**
    *   **在网站所有页面的页脚添加了指向 GitHub Issues 的问题反馈链接，并更新至在线网站**
*   **待完成**:
    *   完善用户文档和FAQ页面
    *   实现网站的移动端适配
    *   **新增需求**: 更新网站展示内容，添加新主题的预览图片和主题切换功能说明

---

## 三、 第三方平台集成 (支付与授权)

**目标**:
*   利用成熟的第三方服务处理在线支付和许可证密钥的自动分发，避免自建后端的复杂性。

**平台选择 (待办事项)**:
*   **需要调研并选择一个合适的平台。** 关键考虑因素：
    *   **费用**: 交易佣金比例、有无月费/年费。
    *   **功能**:
        *   是否支持自动生成和分发许可证密钥？
        *   密钥格式是否可定制？
        *   是否支持买断制 (Perpetual License)？(如果考虑订阅制，则要看订阅管理能力)
        *   税务处理能力 (是否能代缴主要国家/地区的税费？)。
    *   **支付方式**: 支持哪些国际/国内支付方式？
    *   **易用性**: 后台管理界面是否清晰？
    *   **集成性**: 是否提供 API 或 Webhooks 用于未来可能的在线验证？
*   **候选平台示例 (需自行调研对比)**:
    *   国际: Gumroad, Paddle, Lemon Squeezy, FastSpring
    *   国内: 面包多, 爱发电 (可能需要结合其特点看是否完全匹配)

**集成步骤**:

1.  **选择平台**: 完成调研并做出选择。
2.  **注册与配置**: 注册平台账号，配置收款方式、税务信息等。
3.  **创建产品**: 在平台后台创建"专业版"产品，设定价格 (例如 ¥99 买断含一年更新)。
4.  **配置许可证密钥**:
    *   设置由平台 **自动生成** 唯一密钥 (推荐)。
    *   确定密钥格式 (例如，`XXXX-XXXX-XXXX-XXXX`)。
    *   配置购买成功后发送给用户的 **邮件模板**，确保包含密钥和简要激活说明。
5.  **获取购买链接**: 从平台获取该产品的专属购买链接或嵌入式代码。
6.  **网站集成**: 将购买链接/按钮添加到 GitHub Pages 的相关页面。
7.  **实现应用内激活逻辑**:
    *   在**文智搜**中添加 **激活界面** (例如，在"帮助"或"设置"菜单下，提供输入框)。
    *   实现 **密钥验证逻辑**:
        *   **初期 (推荐)**: 实现简单的 **离线格式校验** (例如，检查是否符合 `XXXX-XXXX-XXXX-XXXX` 格式)。这最容易实现，但安全性较低。
        *   *(未来可选)*: 如果平台提供 API，可以实现 **在线验证**，调用 API 查询密钥有效性 (更安全，但需要网络连接和额外开发)。
    *   实现 **激活状态持久化**: 验证成功后，将激活状态安全地存储在本地 (例如，配置文件、注册表)，以便程序下次启动时识别。
8.  **测试**: **彻底测试** 整个流程：用户访问网站 -> 点击购买 -> (模拟)支付 -> 收到邮件和密钥 -> 在软件中输入密钥 -> 确认专业版功能成功解锁。

**实现进度 [新增]**:
*   **已完成**:
    *   已选定并集成易支付作为初始的第三方支付平台。
    *   完成易支付商户后台的产品配置和基本API对接设置。
    *   已在 `docs/purchase.html` 页面集成易支付的购买流程，用户点击购买后可跳转到易支付生成的支付页面。
    *   后端 `api/create-order.js` 能够调用易支付接口创建订单并返回支付URL。
    *   后端 `api/payment-callback.js` 能够接收和验证易支付的异步回调通知，并处理支付成功后的订单更新及许可证邮件发送。
    *   已配置Vercel环境变量以支持易支付API密钥和回调验证。
    *   **易支付平台"授权支付域名"审核已通过，支付功能已可正式使用。**
    *   已完成初步的支付流程测试（用户下单 -> 跳转支付 -> 模拟支付成功 -> 收到回调 -> 邮件发送）。
*   **调研阶段**:
    *   针对国际市场，初步评估了 Gumroad 或 Lemon Squeezy 作为潜在的支付平台选项，但尚未进入具体集成阶段。

**更新后的优先工作 [新增]**:

1. **第三方支付平台整合** (优先级：高) - **状态：基本完成 (易支付)**
   - **已初步集成易支付作为国内支付方案；未来可评估 Gumroad/Lemon Squeezy 作为国际支付选项。**
   - **已在易支付平台完成产品创建及必要的API对接配置。**
   - **已通过后端API生成支付链接并集成到 `purchase.html`。**
   - **已完成易支付的初步购买流程及许可证邮件发送测试。**
   - **持续监控易支付授权域名的审核状态。**
   - **进行更全面的支付流程测试，覆盖各种成功和失败场景。**
   - **完成目标**: 初步实现基于易支付的购买到许可证发放流程，并确保其稳定性。
   - **新增**: 评估并准备支持至少一个国际支付平台 (如 Lemon Squeezy 或 Gumroad) 的技术调研和初步对接准备，以应对未来可能的海外用户。

2. **软件打包与发布准备** (优先级：高) - **状态：初步完成，待测试与发布**
   - **已使用 PyInstaller 成功打包 Windows 版本，生成包含数据文件的可执行程序。**
   - **待办**: 在不同 Windows 版本（特别是干净环境）下对打包后的程序进行全面兼容性测试。
   - **待办**: 将测试通过的程序包压缩为 `.zip` 文件。
   - **待办**: 在 GitHub Releases 上创建正式版本，上传 `.zip` 分发包。
   - **待办**: 更新 GitHub Pages 网站上的下载链接指向 Releases 中的文件。
   - **待办**: 完善安装说明和初始使用引导。
   - **待办**: 建立基础用户使用数据收集系统（遵循隐私原则）。
   - **已完成**: 初步调研 Windows 以外平台 (macOS, Linux) 的打包和分发方案。
   - **完成目标**: 提供一个经过测试、可供用户下载安装的稳定 Windows 版本。

3. **核心搜索体验增强：文件夹树视图与结果筛选** (优先级：高) [新增]
    *   在搜索结果展示区域左侧，实现一个可调整宽度的面板，用于显示文件夹层级树。
    *   文件夹树应能反映当前搜索结果文件所在的目录结构（例如，基于搜索结果动态构建，或基于已索引目录结构并高亮包含结果的文件夹）。
    *   用户点击文件夹树中的节点时，右侧的搜索结果列表应能筛选显示该文件夹（及子文件夹）内的文件。
    *   **技术实现**: 采用 `QSplitter` 实现可调整宽度的面板，`QTreeView` 展示文件夹层级，并与搜索结果进行联动。
    *   **完成目标**: 用户能够通过文件夹树直观了解搜索结果的分布，并能快速按文件夹筛选结果，大幅提升结果定位和管理效率。

4. **文件名搜索功能扩展 (支持多媒体文件)** (优先级：中高) [原第3条调整顺序]
    *   在 `document_search.py` 中更新 `ALLOWED_EXTENSIONS` 或相应的文件扫描逻辑，以包含常见的视频 (如 `.mp4`, `.mkv`, `.avi`)、音频 (如 `.mp3`, `.wav`, `.flac`) 和图片 (如 `.jpg`, `.jpeg`, `.png`, `.gif`, `.bmp`) 文件扩展名，仅用于文件名索引。
    *   确保文件扫描和文件名索引逻辑能够正确识别这些新类型并仅索引其文件名。
    *   (可选) 在UI的设置或文件类型过滤器中增加对这些多媒体类型的勾选项，用于文件名搜索的范围限定。
    *   **完成目标**: 实现对主流视频、音频、图片文件的文件名搜索。

5. **完善产品GitHub Pages网站** (优先级：中) [原第4条调整顺序]
   - 实现详细的用户指南和FAQ页面
   - 添加页面间的导航链接，完善整体用户体验
   - **统一和优化网站各页面的视觉风格**
   - **(已完成) 增加问题反馈渠道 (链接至 GitHub Issues)**
   - **更新**: 添加简化后的主题预览，清晰展示三种现代主题的界面效果
   - **完成目标**: 提供更完善的产品展示和用户支持信息
   - **新增**: 在功能介绍页面明确跨平台支持和扩展文件名搜索是正在规划或未来会加入的功能。

6. **跨平台支持 (macOS, Linux) - 初期研发与适配** (优先级：中) [原第5条调整顺序]
    *   调研并确定各平台下核心依赖 (Tesseract, Poppler 等，如果内容搜索也计划支持这些平台) 的推荐安装和配置方法。
    *   适配 `document_search.py` 中与文件系统、路径相关的硬编码或平台特定逻辑。
    *   在至少一个非Windows平台 (如 macOS 或 একটি主流Linux发行版) 上进行核心后端 (特别是文件扫描、文件名索引) 的初步功能测试。
    *   **完成目标**: 完成核心后端逻辑在至少一个其他平台上的初步验证和适配，为后续完整支持打下基础。

7. **完善错误处理与诊断系统** (优先级：中) [原第6条调整顺序]
   - 增强日志系统，记录更多诊断信息
   - 实现简单的崩溃报告功能
   - 开发诊断工具，帮助解决常见配置问题
   - 完善用户支持材料和常见问题解答
   - **完成目标**: 提高软件稳定性并简化故障排查流程

8. **优化UI体验** (优先级：中低) [原第7条调整顺序]
   - **更新**: 完善现有三种主题的一致性，确保所有控件在各主题下有相同的视觉风格
   - **更新**: 增强主题切换流畅度，改善用户体验
   - **更新**: 优化主题资源（样式表和图标）的加载和管理方式
   - 完善许可证提示系统，为非专业版用户提供明确的主题限制提示
   - 为许可证验证流程添加更友好的视觉反馈
   - **新增**: 优化用户界面布局，提升新用户体验:
     * 移除搜索框前的"搜索词:"标签，使界面更简洁
     * 优化搜索框长度，在保持功能性的同时使界面更紧凑
     * 添加首次启动向导，引导用户完成基本设置和首次索引创建
     * 实现"引导式"索引创建流程，检测是否已配置索引，无配置则自动引导用户设置
     * 在主界面添加状态提示，特别是"尚未创建索引"状态时提供明确引导
     * 添加"快速操作"区，集中常用功能如"创建索引"、"设置"等
     * 增加上下文敏感帮助，关键操作处添加简短说明或帮助图标
     * 将"查看跳过文件"等专业功能移至索引设置界面，减少主界面视觉复杂度
   - **新增核心功能**: 在搜索结果区域左侧集成一个可调整宽度的文件夹树视图 (详细描述见优先工作第3条)。
   - **完成目标**: 提供更专业、统一和用户友好的界面体验，特别优化新用户上手流程，并提供强大的结果导航与筛选能力。

---

## 四、 下一步行动 (Immediate Actions)

**原计划**:
1.  ~~确认功能划分: 最终确认并文档化免费版与专业版的功能界限 (基于本文第一部分)。~~
2.  ~~代码实现功能切换: 在现有代码库中，开始实现基于（尚未存在的）许可证状态来启用/禁用专业版功能的逻辑（使用标志位）。~~
3.  启动 GitHub Pages 建设:
    *   创建 GitHub Pages 仓库。
    *   选择基础主题/技术 (Jekyll/Markdown)。
    *   开始编写核心页面内容，**优先完成下载页和依赖安装指南**。
4.  调研并选择第三方支付/授权平台: 这是关键决策点，需要尽快开始对比分析。
5.  (平台选定后) 注册并配置平台，创建产品，获取购买链接。
6.  开发应用内激活界面和基础验证逻辑。
7.  打包集成测试: 创建包含激活机制的内部测试版本，走通从下载到激活的全流程。

**更新后的优先工作 [新增]**:

1. **第三方支付平台整合** (优先级：高) - **状态：基本完成 (易支付)**
   - **已初步集成易支付作为国内支付方案；未来可评估 Gumroad/Lemon Squeezy 作为国际支付选项。**
   - **已在易支付平台完成产品创建及必要的API对接配置。**
   - **已通过后端API生成支付链接并集成到 `purchase.html`。**
   - **已完成易支付的初步购买流程及许可证邮件发送测试。**
   - **持续监控易支付授权域名的审核状态。**
   - **进行更全面的支付流程测试，覆盖各种成功和失败场景。**
   - **完成目标**: 初步实现基于易支付的购买到许可证发放流程，并确保其稳定性。
   - **新增**: 评估并准备支持至少一个国际支付平台 (如 Lemon Squeezy 或 Gumroad) 的技术调研和初步对接准备，以应对未来可能的海外用户。

2. **软件打包与发布准备** (优先级：高) - **状态：初步完成，待测试与发布**
   - **已使用 PyInstaller 成功打包 Windows 版本，生成包含数据文件的可执行程序。**
   - **待办**: 在不同 Windows 版本（特别是干净环境）下对打包后的程序进行全面兼容性测试。
   - **待办**: 将测试通过的程序包压缩为 `.zip` 文件。
   - **待办**: 在 GitHub Releases 上创建正式版本，上传 `.zip` 分发包。
   - **待办**: 更新 GitHub Pages 网站上的下载链接指向 Releases 中的文件。
   - **待办**: 完善安装说明和初始使用引导。
   - **待办**: 建立基础用户使用数据收集系统（遵循隐私原则）。
   - **已完成**: 初步调研 Windows 以外平台 (macOS, Linux) 的打包和分发方案。
   - **完成目标**: 提供一个经过测试、可供用户下载安装的稳定 Windows 版本。

3. **核心搜索体验增强：文件夹树视图与结果筛选** (优先级：高) [新增]
    *   在搜索结果展示区域左侧，实现一个可调整宽度的面板，用于显示文件夹层级树。
    *   文件夹树应能反映当前搜索结果文件所在的目录结构（例如，基于搜索结果动态构建，或基于已索引目录结构并高亮包含结果的文件夹）。
    *   用户点击文件夹树中的节点时，右侧的搜索结果列表应能筛选显示该文件夹（及子文件夹）内的文件。
    *   **技术实现**: 采用 `QSplitter` 实现可调整宽度的面板，`QTreeView` 展示文件夹层级，并与搜索结果进行联动。
    *   **完成目标**: 用户能够通过文件夹树直观了解搜索结果的分布，并能快速按文件夹筛选结果，大幅提升结果定位和管理效率。

4. **文件名搜索功能扩展 (支持多媒体文件)** (优先级：中高) [原第3条调整顺序]
    *   在 `document_search.py` 中更新 `ALLOWED_EXTENSIONS` 或相应的文件扫描逻辑，以包含常见的视频 (如 `.mp4`, `.mkv`, `.avi`)、音频 (如 `.mp3`, `.wav`, `.flac`) 和图片 (如 `.jpg`, `.jpeg`, `.png`, `.gif`, `.bmp`) 文件扩展名，仅用于文件名索引。
    *   确保文件扫描和文件名索引逻辑能够正确识别这些新类型并仅索引其文件名。
    *   (可选) 在UI的设置或文件类型过滤器中增加对这些多媒体类型的勾选项，用于文件名搜索的范围限定。
    *   **完成目标**: 实现对主流视频、音频、图片文件的文件名搜索。

5. **完善产品GitHub Pages网站** (优先级：中) [原第4条调整顺序]
   - 实现详细的用户指南和FAQ页面
   - 添加页面间的导航链接，完善整体用户体验
   - **统一和优化网站各页面的视觉风格**
   - **(已完成) 增加问题反馈渠道 (链接至 GitHub Issues)**
   - **更新**: 添加简化后的主题预览，清晰展示三种现代主题的界面效果
   - **完成目标**: 提供更完善的产品展示和用户支持信息
   - **新增**: 在功能介绍页面明确跨平台支持和扩展文件名搜索是正在规划或未来会加入的功能。

6. **跨平台支持 (macOS, Linux) - 初期研发与适配** (优先级：中) [原第5条调整顺序]
    *   调研并确定各平台下核心依赖 (Tesseract, Poppler 等，如果内容搜索也计划支持这些平台) 的推荐安装和配置方法。
    *   适配 `document_search.py` 中与文件系统、路径相关的硬编码或平台特定逻辑。
    *   在至少一个非Windows平台 (如 macOS 或 একটি主流Linux发行版) 上进行核心后端 (特别是文件扫描、文件名索引) 的初步功能测试。
    *   **完成目标**: 完成核心后端逻辑在至少一个其他平台上的初步验证和适配，为后续完整支持打下基础。

7. **完善错误处理与诊断系统** (优先级：中) [原第6条调整顺序]
   - 增强日志系统，记录更多诊断信息
   - 实现简单的崩溃报告功能
   - 开发诊断工具，帮助解决常见配置问题
   - 完善用户支持材料和常见问题解答
   - **完成目标**: 提高软件稳定性并简化故障排查流程

8. **优化UI体验** (优先级：中低) [原第7条调整顺序]
   - **更新**: 完善现有三种主题的一致性，确保所有控件在各主题下有相同的视觉风格
   - **更新**: 增强主题切换流畅度，改善用户体验
   - **更新**: 优化主题资源（样式表和图标）的加载和管理方式
   - 完善许可证提示系统，为非专业版用户提供明确的主题限制提示
   - 为许可证验证流程添加更友好的视觉反馈
   - **新增**: 优化用户界面布局，提升新用户体验:
     * 移除搜索框前的"搜索词:"标签，使界面更简洁
     * 优化搜索框长度，在保持功能性的同时使界面更紧凑
     * 添加首次启动向导，引导用户完成基本设置和首次索引创建
     * 实现"引导式"索引创建流程，检测是否已配置索引，无配置则自动引导用户设置
     * 在主界面添加状态提示，特别是"尚未创建索引"状态时提供明确引导
     * 添加"快速操作"区，集中常用功能如"创建索引"、"设置"等
     * 增加上下文敏感帮助，关键操作处添加简短说明或帮助图标
     * 将"查看跳过文件"等专业功能移至索引设置界面，减少主界面视觉复杂度
   - **新增核心功能**: 在搜索结果区域左侧集成一个可调整宽度的文件夹树视图 (详细描述见优先工作第3条)。
   - **完成目标**: 提供更专业、统一和用户友好的界面体验，特别优化新用户上手流程，并提供强大的结果导航与筛选能力。

---

## 五、 待定 / 未来考虑

*   应用更新机制: 规划如何在发布后向用户推送更新。初期考虑实现应用内更新检查（提示用户手动下载新版本），并需结合许可证有效期（例如"一年免费更新"策略）进行处理。未来可考虑集成自动更新器。
*   更复杂的许可证管理（例如，设备数量限制、在线激活吊销）。
*   订阅模式的具体实现。
*   详细的用户行为分析与数据统计。
*   **新增考虑项目 [新增]**:
*   建立简单的错误报告机制，以便用户在遇到问题时能轻松提交反馈
*   考虑为专业版用户提供专属的技术支持渠道
*   评估是否需要开发云同步功能（如索引配置、搜索历史的同步）
*   **更新**: 考虑未来为专业版增加主题定制选项，允许用户调整主题的亮度或色调
*   **更新**: 评估是否在未来版本中逐步添加新主题，作为专业版的增值内容
*   考虑定期更新专业版主题库，增加季节性或特别版主题

---

本文档将持续更新，以反映商业化实施过程中的进展和决策。 